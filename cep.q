upd:insert

/ tp and gw handles
.u.x:.z.x,count[.z.x]_(":5010";":5013");
.u.h:hopen`$":",.u.x 1

.u.rep:{.[;();:;]. x;x[0]insert((),`date)_.u.h(`.u.qry;x 0;.z.d;`)}
.u.end:{t:tables`.;t@:where`g=attr each t@\:`sym;@[`.;;0#]each t;@[;`sym;`g#]each t;}

.u.rep each(hopen`$":",.u.x 0)(`.u.sub;`;`);
